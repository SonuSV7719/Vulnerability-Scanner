import streamlit as st

def diffie_hellman(prime, base, secret_a, secret_b):
    public_a = (base ** secret_a) % prime
    public_b = (base ** secret_b) % prime

    shared_a = (public_b ** secret_a) % prime
    shared_b = (public_a ** secret_b) % prime

    st.write("Public Key for User A:", public_a)
    st.write("Public Key for User B:", public_b)
    st.write("Shared Key for User A:", shared_a)
    st.write("Shared Key for User B:", shared_b)


st.title("Diffie-Hellman Key Exchange")
st.write("Enter the values and click 'Run' to perform the key exchange.")

prime = st.number_input("Enter a prime number (p)", value=23)
base = st.number_input("Enter a base number (g)", value=5)
secret_a = st.number_input("Enter User A's secret value (a)", value=6)
secret_b = st.number_input("Enter User B's secret value (b)", value=15)

if st.button("Run"):
    diffie_hellman(prime, base, secret_a, secret_b)
